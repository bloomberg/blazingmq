<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libbmq: bmqt/bmqt_uri.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libbmq<span id="projectnumber">&#160;038d19a514d625ae36de21ead14346e4ceafd7e9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('bmqt__uri_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">bmqt_uri.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Provide value-semantic type and utilities for a BlazingMQ queue URI.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;ball_log.h&gt;</code><br />
<code>#include &lt;bsl_cstddef.h&gt;</code><br />
<code>#include &lt;bsl_iosfwd.h&gt;</code><br />
<code>#include &lt;bsl_string.h&gt;</code><br />
<code>#include &lt;bslh_hash.h&gt;</code><br />
<code>#include &lt;bslma_usesbslmaallocator.h&gt;</code><br />
<code>#include &lt;bslmf_nestedtraitdeclaration.h&gt;</code><br />
</div>
<p><a href="bmqt__uri_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">BloombergLP::bmqt::Uri</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value semantic type representing a URI.  <a href="classBloombergLP_1_1bmqt_1_1Uri.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBloombergLP_1_1bmqt_1_1UriParser.html">BloombergLP::bmqt::UriParser</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility namespace of methods for parsing URI strings into <code><a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html" title="Value semantic type representing a URI.">Uri</a></code> objects.  <a href="structBloombergLP_1_1bmqt_1_1UriParser.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBloombergLP_1_1bmqt_1_1UriBuilder.html">BloombergLP::bmqt::UriBuilder</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceBloombergLP" id="r_namespaceBloombergLP"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBloombergLP.html">BloombergLP</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceBloombergLP_1_1bmqt" id="r_namespaceBloombergLP_1_1bmqt"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBloombergLP_1_1bmqt.html">BloombergLP::bmqt</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac48cbe60996c895ee24d14d2cc8bff01" id="r_ac48cbe60996c895ee24d14d2cc8bff01"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBloombergLP_1_1bmqt.html#ac48cbe60996c895ee24d14d2cc8bff01">BloombergLP::bmqt::operator==</a> (const <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">Uri</a> &amp;lhs, const <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">Uri</a> &amp;rhs)</td></tr>
<tr class="separator:ac48cbe60996c895ee24d14d2cc8bff01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add32cc6a88489f15691c3d7f0958c3ab" id="r_add32cc6a88489f15691c3d7f0958c3ab"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBloombergLP_1_1bmqt.html#add32cc6a88489f15691c3d7f0958c3ab">BloombergLP::bmqt::operator!=</a> (const <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">Uri</a> &amp;lhs, const <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">Uri</a> &amp;rhs)</td></tr>
<tr class="separator:add32cc6a88489f15691c3d7f0958c3ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf92ec381d2db68f75a6e955968d9be3" id="r_acf92ec381d2db68f75a6e955968d9be3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBloombergLP_1_1bmqt.html#acf92ec381d2db68f75a6e955968d9be3">BloombergLP::bmqt::operator&lt;</a> (const <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">Uri</a> &amp;lhs, const <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">Uri</a> &amp;rhs)</td></tr>
<tr class="separator:acf92ec381d2db68f75a6e955968d9be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55fa376a6ddfcb542481ebc997640ec" id="r_aa55fa376a6ddfcb542481ebc997640ec"><td class="memItemLeft" align="right" valign="top">bsl::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBloombergLP_1_1bmqt.html#aa55fa376a6ddfcb542481ebc997640ec">BloombergLP::bmqt::operator&lt;&lt;</a> (bsl::ostream &amp;stream, const <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">Uri</a> &amp;rhs)</td></tr>
<tr class="separator:aa55fa376a6ddfcb542481ebc997640ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c527cc9c3ecaf34c1fcc1618818f4b9" id="r_a6c527cc9c3ecaf34c1fcc1618818f4b9"><td class="memTemplParams" colspan="2">template&lt;class HASH_ALGORITHM &gt; </td></tr>
<tr class="memitem:a6c527cc9c3ecaf34c1fcc1618818f4b9"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceBloombergLP_1_1bmqt.html#a6c527cc9c3ecaf34c1fcc1618818f4b9">BloombergLP::bmqt::hashAppend</a> (HASH_ALGORITHM &amp;hashAlgo, const <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">Uri</a> &amp;uri)</td></tr>
<tr class="separator:a6c527cc9c3ecaf34c1fcc1618818f4b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This component provides a value-semantic type, <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">bmqt::Uri</a> representing a URI for a BlazingMQ queue. A <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">bmqt::Uri</a> can be built by parsing from a string representation, using the <a class="el" href="structBloombergLP_1_1bmqt_1_1UriParser.html">bmqt::UriParser</a>, or built using the <a class="el" href="classBloombergLP_1_1bmqt_1_1UriBuilder.html">bmqt::UriBuilder</a>.</p>
<dl class="section see"><dt>See also</dt><dd><a href="https://tools.ietf.org/html/rfc3986">https://tools.ietf.org/html/rfc3986</a></dd></dl>
<h1><a class="anchor" id="bmqt_uri_format"></a>
URI format</h1>
<p>In a nutshell, a URI representing an application queue managed by a BlazingMQ broker on a given machine looks like one of the following:</p>
<div class="fragment"><div class="line">bmq:<span class="comment">//ts.trades.myapp/my.queue</span></div>
<div class="line">bmq:<span class="comment">//ts.trades.myapp.~bt/my.queue</span></div>
<div class="line">bmq:<span class="comment">//ts.trades.myapp/my.queue?id=foo</span></div>
</div><!-- fragment --><p>where:</p>
<ul>
<li>The URI scheme is always "bmq".</li>
<li>The URI authority is the name of BlazingMQ domain (such as "ts.trades.myapp") as registered with the BlazingMQ infrastructure. The domain name may contain alphanumeric characters, dots and dashes (it has to match the following regular expression: <code>[-a-zA-Z0-9\\._]+</code>). The domain may be followed by an optional tier, introduced by the ".~" sequence and consisting of alphanumeric characters and dashes. The ".~" sequence is not part of the tier.</li>
<li>The URI path is the name of the queue ("my.queue" above) and may contain alphanumeric characters, dashes, underscores and tild (it has to match the following regular expression: <code>[-a-zA-Z0-9_~\\.]+</code>). The queue name must be less than <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html#a6983f1d469602e6c19668797e44eb9dc">bmqt::Uri::k_QUEUENAME_MAX_LENGTH</a> characters long.</li>
<li>The name of the queue ("my.queue" above) may contain alphanumeric characters and dots.</li>
<li>The URI may contain an optional query with a key-value pair. Currently supported keys are:<ul>
<li><em>id</em>: the corresponding value represents a name that will be used by BlazingMQ broker to uniquely identify the client.</li>
</ul>
</li>
<li>The URI fragment part is currently unused.</li>
</ul>
<h1><a class="anchor" id="bmqt_uri_ex1"></a>
Usage Example 1</h1>
<p>First, call the <code>initialize</code> method of the <a class="el" href="structBloombergLP_1_1bmqt_1_1UriParser.html">bmqt::UriParser</a>. This call is only needed one time; you can call it when your task starts.</p>
<p>Note that the <code>bmq</code> library takes care of that, so users of <code>bmq</code> don't have to explicitly do it themselves.</p>
<div class="fragment"><div class="line">bmqt::UriParser::initialize();</div>
</div><!-- fragment --><p>Then, parse a URI string created on the stack to populate a <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">bmqt::Uri</a> object. The parse function takes an optional error string which is populated with a short error message if the URI is not formatted correctly.</p>
<div class="fragment"><div class="line">bsl::string input = <span class="stringliteral">&quot;bmq://my.domain/queue&quot;</span>;</div>
<div class="line">bmqt::Uri   uri(allocator);</div>
<div class="line">bsl::string errorDescription;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span>         rc = bmqt::UriParser::parse(&amp;uri, &amp;errorDescription, input);</div>
<div class="line"><span class="keywordflow">if</span> (rc != 0) {</div>
<div class="line">   BALL_LOG_ERROR &lt;&lt; <span class="stringliteral">&quot;Invalid URI [error: &quot;</span> &lt;&lt; errorDescription &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line">}</div>
<div class="line">assert(rc == 0);</div>
<div class="line">assert(error == <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">assert(uri.scheme()    == <span class="stringliteral">&quot;bmq&quot;</span>);</div>
<div class="line">assert(uri.domain()    == <span class="stringliteral">&quot;my.domain&quot;</span>);</div>
<div class="line">assert(uri.queue()     == <span class="stringliteral">&quot;queue&quot;</span>);</div>
</div><!-- fragment --><h1><a class="anchor" id="bmqt_uri_ex2"></a>
Usage Example 2</h1>
<p>Instantiate a <a class="el" href="classBloombergLP_1_1bmqt_1_1Uri.html">bmqt::Uri</a> object with a string representation of the URI and an allocator.</p>
<div class="fragment"><div class="line">bmqt::Uri uri(<span class="stringliteral">&quot;bmq://my.domain/queue&quot;</span>, allocator);</div>
<div class="line">assert(uri.scheme() == <span class="stringliteral">&quot;bmq&quot;</span>);</div>
<div class="line">assert(uri.domain() == <span class="stringliteral">&quot;my.domain&quot;</span>);</div>
<div class="line">assert(uri.queue()  == <span class="stringliteral">&quot;queue&quot;</span>);</div>
</div><!-- fragment --><h1><a class="anchor" id="bmqt_uri_thread"></a>
Thread Safety</h1>
<ul>
<li><a class="el" href="classBloombergLP_1_1bmqt_1_1UriBuilder.html">bmqt::UriBuilder</a> is NOT thread safe.</li>
<li><a class="el" href="structBloombergLP_1_1bmqt_1_1UriParser.html">bmqt::UriParser</a> should be thread safe: the component depends on <code>bdepcre_regex</code> that is a wrapper around "pcre.h". See <a href="http://www.pcre.org/pcre.txt">http://www.pcre.org/pcre.txt</a>. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_8e091ab1c7d4f7f0c38972fd2ce6f060.html">bmqt</a></li><li class="navelem"><a class="el" href="bmqt__uri_8h.html">bmqt_uri.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
